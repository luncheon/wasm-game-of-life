var y="./wasm_game_of_life_bg.wasm";var z=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder,K=new z("utf-8",{ignoreBOM:!0,fatal:!0});K.decode();var w=null;function AA(){return(w===null||w.buffer!==_.buffer)&&(w=new Uint8Array(_.buffer)),w}function eA(e,A){return K.decode(AA().subarray(e,e+A))}var c=class{static __wrap(A){let t=Object.create(c.prototype);return t.ptr=A,t}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();G(A)}constructor(A,t){var r=$(A,t);return c.__wrap(r)}random(){F(this.ptr)}single_space_ship(A,t){M(this.ptr,A,t)}get as_ptr(){var A=C(this.ptr);return A}get cells_ptr(){var A=R(this.ptr);return A}get row_count(){var A=P(this.ptr);return A>>>0}get column_count(){var A=D(this.ptr);return A>>>0}tick(){H(this.ptr)}},u=class{static __wrap(A){let t=Object.create(u.prototype);return t.ptr=A,t}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();L(A)}constructor(A,t,r,o,l){var d=S(A,t,r,o,l);return u.__wrap(d)}get width(){var A=T(this.ptr);return A>>>0}get height(){var A=N(this.ptr);return A>>>0}get data_ptr(){var A=W(this.ptr);return A}draw(){J(this.ptr)}};function B(){var e=Date.now();return e}function O(e,A){throw new Error(eA(e,A))}var rA={["./wasm_game_of_life_bg.js"]:{__wbg_now_c3277d0b8a8f625b:B,__wbindgen_throw:O}};async function jA(e,A){if(typeof e=="string"){let t=await fetch(e);if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,A)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn(r);else throw r}e=await t.arrayBuffer()}return await WebAssembly.instantiate(e,A)}var{instance:n,module:_A}=await jA(y,rA),_=n.exports.memory,G=n.exports.__wbg_universe_free,$=n.exports.universe_new,F=n.exports.universe_random,M=n.exports.universe_single_space_ship,C=n.exports.universe_as_ptr,R=n.exports.universe_cells_ptr,P=n.exports.universe_row_count,D=n.exports.universe_column_count,H=n.exports.universe_tick,L=n.exports.__wbg_universecanvasdrawer_free,S=n.exports.universecanvasdrawer_new,T=n.exports.universecanvasdrawer_width,N=n.exports.universecanvasdrawer_height,W=n.exports.universecanvasdrawer_data_ptr,J=n.exports.universecanvasdrawer_draw;var s=document.body.appendChild(document.createElement("canvas")),i=document.body.appendChild(document.createElement("aside"));i.style.position="fixed";i.style.top="16px";i.style.left="16px";i.style.padding="4px";i.style.background="rgba(255,255,255,.8)";var j=3,V=[204,204,204],q=[255,255,255],f=[0,0,0],a=new c(800,800);a.random();var g=([e,A,t])=>`rgb(${e},${A},${t})`,p=([e,A,t])=>(255<<24)+(t<<16)+(A<<8)+e,nA=(()=>{let e=i.appendChild(document.createElement("div"));e.style.color="hsl(150,100%,50%)",e.style.textShadow="1px 1px 1px hsl(150,100%,20%)",e.style.fontVariantNumeric="tabular-nums",e.textContent="0 fps";let A=0,t=performance.now();return setInterval(()=>{let r=performance.now();e.textContent=`${Math.round(A*1e3/(r-t))} fps`,A=0,t=r},512),()=>A++})(),E=e=>{let A,t=()=>{e(),nA(),A=requestAnimationFrame(t)};return t(),{cancel:()=>A!==void 0&&cancelAnimationFrame(A)}},Q=e=>{let A=new Uint8Array(_.buffer,a.cells_ptr,a.row_count*a.column_count),t=0;for(let r=0;r<a.row_count;r++)for(let o=0;o<a.column_count;o++)e(r,o,A[t]),t++},X=e=>{e.beginPath(),e.strokeStyle=g(V);for(let A=0;A<=a.column_count;A++)e.moveTo(A*(j+1)+1,0),e.lineTo(A*(j+1)+1,e.canvas.height);for(let A=0;A<=a.row_count;A++)e.moveTo(0,A*(j+1)+1),e.lineTo(e.canvas.width,A*(j+1)+1);e.stroke()},aA=()=>{s.width=(j+1)*a.column_count+1,s.height=(j+1)*a.row_count+1;let e=s.getContext("2d");X(e);let A=g(q),t=g(f),r=()=>{Q((o,l,d)=>{e.fillStyle=d?t:A,e.fillRect(l*(j+1)+1,o*(j+1)+1,j,j)})};return E(()=>{r(),a.tick()})},sA=()=>{s.width=(j+1)*a.column_count+1,s.height=(j+1)*a.row_count+1;let e=s.getContext("2d");X(e);let A=e.getImageData(0,0,s.width,s.height),t=new Uint32Array(A.data.buffer),r=(v,m,k,b,Y)=>{let I=v+m*s.width;for(let x=0;x<b;x++){for(let h=0;h<k;h++)t[I+h]=Y;I+=s.width}},o=p(q),l=p(f),d=()=>{Q((v,m,k)=>{let b=k?l:o;r(m*(j+1)+1,v*(j+1)+1,j,j,b)}),e.putImageData(A,0,0)};return E(()=>{d(),a.tick()})},U=()=>{let e=new u(a.as_ptr,j,p(V),p(q),p(f)),A=new ImageData(new Uint8ClampedArray(_.buffer,e.data_ptr,e.width*e.height*4),e.width,e.height);s.width=e.width,s.height=e.height;let t=s.getContext("2d");return E(()=>{e.draw(),t.putImageData(A,0,0),a.tick()})};{let{cancel:e}=U(),A=i.appendChild(document.createElement("div"));A.innerHTML=`
    <label><input type="radio" name="renderer">Stop</label><br>
    <label><input type="radio" name="renderer" value="canvas-api">fillRect (JS)</label><br>
    <label><input type="radio" name="renderer" value="image-data">putImageData (JS)</label><br>
    <label><input type="radio" name="renderer" value="wasm" checked>putImageData (WASM)</label><br>
  `,A.addEventListener("change",t=>{if(!(!(t.target instanceof HTMLInputElement)||t.target.name!=="renderer"))switch(e(),t.target.value){case"canvas-api":({cancel:e}=aA());break;case"image-data":({cancel:e}=sA());break;case"wasm":({cancel:e}=U());break;default:e=()=>{};break}})}
