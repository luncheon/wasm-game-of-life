var F="./wasm_game_of_life_bg.wasm";var Z=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder,G=new Z("utf-8",{ignoreBOM:!0,fatal:!0});G.decode();var _=null;function AA(){return(_===null||_.buffer!==d.buffer)&&(_=new Uint8Array(d.buffer)),_}function jA(j,A){return G.decode(AA().subarray(j,j+A))}var u=class{static __wrap(A){let e=Object.create(u.prototype);return e.ptr=A,e}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();x(A)}constructor(A,e){var r=K(A,e);return u.__wrap(r)}random(){O(this.ptr)}single_space_ship(A,e){M(this.ptr,A,e)}get as_ptr(){var A=C(this.ptr);return A}get cells_ptr(){var A=L(this.ptr);return A}get row_count(){var A=D(this.ptr);return A>>>0}get column_count(){var A=H(this.ptr);return A>>>0}tick(){J(this.ptr)}},v=class{static __wrap(A){let e=Object.create(v.prototype);return e.ptr=A,e}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();N(A)}constructor(A,e,r,o,c){var l=R(A,e,r,o,c);return v.__wrap(l)}get width(){var A=U(this.ptr);return A>>>0}get height(){var A=P(this.ptr);return A>>>0}get data_ptr(){var A=S(this.ptr);return A}draw(){T(this.ptr)}};function I(){var j=Date.now();return j}function y(j,A){throw new Error(jA(j,A))}var rA={["./wasm_game_of_life_bg.js"]:{__wbg_now_c3277d0b8a8f625b:I,__wbindgen_throw:y}};async function tA(j,A){if(typeof j=="string"){let e=await fetch(j);if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,A)}catch(r){if(e.headers.get("Content-Type")!="application/wasm")console.warn(r);else throw r}j=await e.arrayBuffer()}return await WebAssembly.instantiate(j,A)}var{instance:n,module:vA}=await tA(F,rA),d=n.exports.memory,x=n.exports.__wbg_universe_free,K=n.exports.universe_new,O=n.exports.universe_random,M=n.exports.universe_single_space_ship,C=n.exports.universe_as_ptr,L=n.exports.universe_cells_ptr,D=n.exports.universe_row_count,H=n.exports.universe_column_count,J=n.exports.universe_tick,N=n.exports.__wbg_universecanvasdrawer_free,R=n.exports.universecanvasdrawer_new,U=n.exports.universecanvasdrawer_width,P=n.exports.universecanvasdrawer_height,S=n.exports.universecanvasdrawer_data_ptr,T=n.exports.universecanvasdrawer_draw;var s=document.body.appendChild(document.createElement("canvas")),i=document.body.appendChild(document.createElement("aside"));i.style.position="fixed";i.style.top="16px";i.style.left="16px";i.style.padding="4px";i.style.background="rgba(255,255,255,.8)";var t=5,Y=[204,204,204],E=[255,255,255],h=[0,0,0],a=new u(600,300);a.random();var b=([j,A,e])=>`rgb(${j},${A},${e})`,q=([j,A,e])=>(255<<24)+(e<<16)+(A<<8)+j,nA=(()=>{let j=i.appendChild(document.createElement("div"));j.style.color="hsl(150,100%,50%)",j.style.textShadow="1px 1px 1px hsl(150,100%,20%)",j.style.fontVariantNumeric="tabular-nums",j.textContent="0 fps";let A=0,e=performance.now();return setInterval(()=>{let r=performance.now();j.textContent=`${Math.round(A*1e3/(r-e))} fps`,A=0,e=r},512),()=>A++})(),g=j=>{let A,e=()=>{j(),nA(),A=requestAnimationFrame(e)};return e(),{cancel:()=>A!==void 0&&cancelAnimationFrame(A)}},z=j=>{let A=new Uint8Array(d.buffer,a.cells_ptr,Math.ceil(a.row_count*a.column_count/8)),e=0,r=1;for(let o=0;o<a.row_count;o++)for(let c=0;c<a.column_count;c++)j(o,c,(A[e]&r)===r),r===1<<7?(r=1,e++):r<<=1},V=j=>{j.beginPath(),j.strokeStyle=b(Y);for(let A=0;A<=a.column_count;A++)j.moveTo(A*(t+1)+1,0),j.lineTo(A*(t+1)+1,j.canvas.height);for(let A=0;A<=a.row_count;A++)j.moveTo(0,A*(t+1)+1),j.lineTo(j.canvas.width,A*(t+1)+1);j.stroke()},aA=()=>{s.width=(t+1)*a.column_count+1,s.height=(t+1)*a.row_count+1;let j=s.getContext("2d");V(j);let A=b(E),e=b(h),r=()=>{z((o,c,l)=>{j.fillStyle=l?e:A,j.fillRect(c*(t+1)+1,o*(t+1)+1,t,t)})};return g(()=>{r(),a.tick()})},sA=()=>{s.width=(t+1)*a.column_count+1,s.height=(t+1)*a.row_count+1;let j=s.getContext("2d");V(j);let A=j.getImageData(0,0,s.width,s.height),e=new Uint32Array(A.data.buffer),r=(k,p,w,m,Q)=>{let f=k+p*s.width;for(let B=0;B<m;B++){for(let $=0;$<w;$++)e[f+$]=Q;f+=s.width}},o=q(E),c=q(h),l=()=>{z((k,p,w)=>{let m=w?c:o;r(p*(t+1)+1,k*(t+1)+1,t,t,m)}),j.putImageData(A,0,0)};return g(()=>{l(),a.tick()})},W=()=>{let j=new v(a.as_ptr,t,q(Y),q(E),q(h)),A=new ImageData(new Uint8ClampedArray(d.buffer,j.data_ptr,j.width*j.height*4),j.width,j.height);s.width=j.width,s.height=j.height;let e=s.getContext("2d");return g(()=>{j.draw(),e.putImageData(A,0,0),a.tick()})};{let{cancel:j}=W(),A=i.appendChild(document.createElement("div"));A.innerHTML=`
    <label><input type="radio" name="renderer">Stop</label><br>
    <label><input type="radio" name="renderer" value="canvas-api">fillRect (JS)</label><br>
    <label><input type="radio" name="renderer" value="image-data">putImageData (JS)</label><br>
    <label><input type="radio" name="renderer" value="wasm" checked>putImageData (WASM)</label><br>
  `,A.addEventListener("change",e=>{if(!(!(e.target instanceof HTMLInputElement)||e.target.name!=="renderer"))switch(j(),e.target.value){case"canvas-api":({cancel:j}=aA());break;case"image-data":({cancel:j}=sA());break;case"wasm":({cancel:j}=W());break;default:j=()=>{};break}})}
