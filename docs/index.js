var C="./wasm_game_of_life_bg.wasm";var aA=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder,F=new aA("utf-8",{ignoreBOM:!0,fatal:!0});F.decode();var x=null;function sA(){return(x===null||x.buffer!==f.buffer)&&(x=new Uint8Array(f.buffer)),x}function oA(e,A){return F.decode(sA().subarray(e,e+A))}var h=class{static __wrap(A){let t=Object.create(h.prototype);return t.ptr=A,t}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();L(A)}constructor(A,t){var r=O(A,t);return h.__wrap(r)}random(){R(this.ptr)}single_space_ship(A,t){G(this.ptr,A,t)}get as_ptr(){var A=T(this.ptr);return A}get cells_ptr(){var A=S(this.ptr);return A}get row_count(){var A=H(this.ptr);return A>>>0}get column_count(){var A=U(this.ptr);return A>>>0}set_cell_alive(A,t,r){N(this.ptr,A,t,r)}tick(){W(this.ptr)}},g=class{static __wrap(A){let t=Object.create(g.prototype);return t.ptr=A,t}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();P(A)}constructor(A,t,r,n,a){var u=V(A,t,r,n,a);return g.__wrap(u)}get width(){var A=Y(this.ptr);return A>>>0}get height(){var A=X(this.ptr);return A>>>0}get data_ptr(){var A=J(this.ptr);return A}draw_cells(A){Z(this.ptr,A)}};function D(){var e=Date.now();return e}function K(e,A){throw new Error(oA(e,A))}var iA={["./wasm_game_of_life_bg.js"]:{__wbg_now_c3277d0b8a8f625b:D,__wbindgen_throw:K}};async function cA(e,A){if(typeof e=="string"){let t=await fetch(e);if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,A)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn(r);else throw r}e=await t.arrayBuffer()}return await WebAssembly.instantiate(e,A)}var{instance:o,module:bA}=await cA(C,iA),f=o.exports.memory,L=o.exports.__wbg_universe_free,O=o.exports.universe_new,R=o.exports.universe_random,G=o.exports.universe_single_space_ship,T=o.exports.universe_as_ptr,S=o.exports.universe_cells_ptr,H=o.exports.universe_row_count,U=o.exports.universe_column_count,N=o.exports.universe_set_cell_alive,W=o.exports.universe_tick,P=o.exports.__wbg_universecanvasdrawer_free,V=o.exports.universecanvasdrawer_new,Y=o.exports.universecanvasdrawer_width,X=o.exports.universecanvasdrawer_height,J=o.exports.universecanvasdrawer_data_ptr,Z=o.exports.universecanvasdrawer_draw_cells;var m=document.body.appendChild(document.createElement("aside"));m.style.position="fixed";m.style.top="16px";m.style.right="16px";m.style.padding="4px";m.style.background="rgba(255,255,255,.8)";m.style.whiteSpace="nowrap";m.style.userSelect="none";var v=3,_=v+1,Q=[204,204,204],I=[255,255,255],B=[0,0,0],z=([e,A,t])=>`rgb(${e},${A},${t})`,q=([e,A,t])=>(255<<24)+(t<<16)+(A<<8)+e,lA=(()=>{let e=m.appendChild(document.createElement("div"));e.style.float="right",e.style.color="hsl(150,100%,50%)",e.style.textShadow="1px 1px 1px hsl(150,100%,20%)",e.style.fontVariantNumeric="tabular-nums",e.textContent="0 fps";let A=0,t=performance.now();return setInterval(()=>{let r=performance.now();e.textContent=`${Math.round(A*1e3/(r-t))} fps`,A=0,t=r},512),()=>A++})(),uA=e=>{let A,t=()=>{e(),lA(),A=requestAnimationFrame(t)};return t(),{stop:()=>A!==void 0&&cancelAnimationFrame(A)}},k=(e,A,t)=>{let{row_count:r,column_count:n}=e,a=new Uint8Array(f.buffer,e.cells_ptr,r*n),u=0;for(let i=0;i<r;i++)for(let c=0;c<n;c++){let d=a[u];(!t||d&2)&&A(i,c,d&1),u++}},AA=e=>{let A=e.getImageData(0,0,e.canvas.width,e.canvas.height),t=new Int32Array(A.data.buffer),r=q(Q);for(let n=0;n<e.canvas.width;n+=_)for(let a=0;a<e.canvas.height;a++)t[a*e.canvas.width+n]=r;for(let n=0;n<e.canvas.height;n+=_)for(let a=0;a<e.canvas.width;a++)t[n*e.canvas.width+a]=r;e.putImageData(A,0,0)},dA=(e,A)=>{e.width=_*A.column_count+1,e.height=_*A.row_count+1;let t=e.getContext("2d");AA(t);let r=z(I),n=z(B),a=(u,i,c)=>{t.fillStyle=c?n:r,t.fillRect(i*_+1,u*_+1,v,v)};return k(A,a),()=>k(A,a,!0)},_A=(e,A)=>{e.width=_*A.column_count+1,e.height=_*A.row_count+1;let t=e.getContext("2d");AA(t);let r=t.getImageData(0,0,e.width,e.height),n=new Int32Array(r.data.buffer),a=(d,s,j,l,b)=>{let p=d+s*e.width;for(let E=0;E<l;E++){for(let w=0;w<j;w++)n[p+w]=b;p+=e.width}},u=q(I),i=q(B),c=(d,s,j)=>{a(s*_+1,d*_+1,v,v,j?i:u)};return k(A,c),t.putImageData(r,0,0),()=>{k(A,c,!0),t.putImageData(r,0,0)}},pA=(e,A)=>{let t=new g(A.as_ptr,v,q(Q),q(I),q(B)),r=new ImageData(new Uint8ClampedArray(f.buffer,t.data_ptr,t.width*t.height*4),t.width,t.height);e.width=t.width,e.height=t.height;let n=e.getContext("2d");return t.draw_cells(!1),n.putImageData(r,0,0),()=>{t.draw_cells(!1),n.putImageData(r,0,0)}};{let e=document.body.appendChild(document.createElement("canvas")),A=new h(200,200);A.random();let t=s=>Math.min(Math.floor(s),A.row_count-1),r=s=>Math.min(Math.floor(s),A.column_count-1),n=(s,j)=>{let l=e.getBoundingClientRect(),b=(s-l.x-1)*e.width/l.width,p=(j-l.y-1)*e.height/l.height;return[t(p/(v+1)),r(b/(v+1))]};addEventListener("pointerdown",s=>{if(s.target===e){let[j,l]=n(s.clientX,s.clientY);A.set_cell_alive(j,l,!0),i();let b=E=>{let[w,$]=n(E.clientX,E.clientY),eA=Math.hypot(w-j,$-l),M=Math.atan2(w-j,$-l),tA=Math.sin(M),rA=Math.cos(M);for(let y=0;y<eA;y++)A.set_cell_alive(t(j+y*tA),r(l+y*rA),!0);A.set_cell_alive(j,l,!0),j=w,l=$,i()},p=()=>{removeEventListener("pointerup",p),removeEventListener("pointercancel",p),removeEventListener("pointermove",b),d()};addEventListener("pointerup",p),addEventListener("pointercancel",p),addEventListener("pointermove",b),c()}});let a=()=>(e.remove(),e.width=0,e.height=0,e=document.body.appendChild(document.createElement("canvas")),e.style.cursor="crosshair",e),u=m.appendChild(document.createElement("div"));u.innerHTML=`
    <fieldset>
      <legend style="padding:0 8px">Renderer</legend>
      <label style="cursor:pointer"><input type="radio" name="renderer">Stop</label><br>
      <label style="cursor:pointer"><input type="radio" name="renderer" value="canvas-api">fillRect (JS)</label><br>
      <label style="cursor:pointer"><input type="radio" name="renderer" value="image-data">putImageData (JS)</label><br>
      <label style="cursor:pointer"><input type="radio" name="renderer" value="wasm" checked>putImageData (WASM)</label><br>
    </fieldset>
    <fieldset>
      <legend style="padding:0 8px">Vastness</legend>
      <label style="cursor:pointer"><input type="radio" name="vastness" value="200" checked>200x200</label><br>
      <label style="cursor:pointer"><input type="radio" name="vastness" value="400">400x400</label><br>
      <label style="cursor:pointer"><input type="radio" name="vastness" value="600">600x600</label><br>
      <label style="cursor:pointer"><input type="radio" name="vastness" value="800">800x800</label><br>
    </fieldset>
  `,u.addEventListener("change",s=>{if(s.target instanceof HTMLInputElement){if(c(),s.target.name==="vastness"){let j=+s.target.value;A=new h(j,j),A.random()}d()}});let i,c,d=()=>{switch(u.querySelector("[name=renderer]:checked").value){case"canvas-api":i=dA(a(),A);break;case"image-data":i=_A(a(),A);break;case"wasm":i=pA(a(),A);break;default:c=()=>{};return}({stop:c}=uA(()=>{A.tick(),i()}))};d()}
