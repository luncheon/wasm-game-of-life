var K="./wasm_game_of_life_bg.wasm";var AA=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder,B=new AA("utf-8",{ignoreBOM:!0,fatal:!0});B.decode();var m=null;function eA(){return(m===null||m.buffer!==d.buffer)&&(m=new Uint8Array(d.buffer)),m}function tA(A,e){return B.decode(eA().subarray(A,A+e))}var u=class{static __wrap(e){let t=Object.create(u.prototype);return t.ptr=e,t}__destroy_into_raw(){let e=this.ptr;return this.ptr=0,e}free(){let e=this.__destroy_into_raw();F(e)}constructor(e,t){var r=$(e,t);return u.__wrap(r)}random(){M(this.ptr)}single_space_ship(e,t){C(this.ptr,e,t)}get as_ptr(){var e=R(this.ptr);return e}get cells_ptr(){var e=D(this.ptr);return e}get row_count(){var e=P(this.ptr);return e>>>0}get column_count(){var e=H(this.ptr);return e>>>0}tick(){S(this.ptr)}},l=class{static __wrap(e){let t=Object.create(l.prototype);return t.ptr=e,t}__destroy_into_raw(){let e=this.ptr;return this.ptr=0,e}free(){let e=this.__destroy_into_raw();L(e)}constructor(e,t,r,n,j){var i=T(e,t,r,n,j);return l.__wrap(i)}get width(){var e=N(this.ptr);return e>>>0}get height(){var e=W(this.ptr);return e>>>0}get data_ptr(){var e=J(this.ptr);return e}draw(){U(this.ptr)}};function O(){var A=Date.now();return A}function G(A,e){throw new Error(tA(A,e))}var jA={["./wasm_game_of_life_bg.js"]:{__wbg_now_c3277d0b8a8f625b:O,__wbindgen_throw:G}};async function nA(A,e){if(typeof A=="string"){let t=await fetch(A);if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn(r);else throw r}A=await t.arrayBuffer()}return await WebAssembly.instantiate(A,e)}var{instance:a,module:dA}=await nA(K,jA),d=a.exports.memory,F=a.exports.__wbg_universe_free,$=a.exports.universe_new,M=a.exports.universe_random,C=a.exports.universe_single_space_ship,R=a.exports.universe_as_ptr,D=a.exports.universe_cells_ptr,P=a.exports.universe_row_count,H=a.exports.universe_column_count,S=a.exports.universe_tick,L=a.exports.__wbg_universecanvasdrawer_free,T=a.exports.universecanvasdrawer_new,N=a.exports.universecanvasdrawer_width,W=a.exports.universecanvasdrawer_height,J=a.exports.universecanvasdrawer_data_ptr,U=a.exports.universecanvasdrawer_draw;var c=document.body.appendChild(document.createElement("aside"));c.style.position="fixed";c.style.top="16px";c.style.left="16px";c.style.padding="4px";c.style.background="rgba(255,255,255,.8)";c.style.userSelect="none";var s=3,X=[204,204,204],E=[255,255,255],I=[0,0,0],o=new u(800,800);o.random();var V=([A,e,t])=>`rgb(${A},${e},${t})`,_=([A,e,t])=>(255<<24)+(t<<16)+(e<<8)+A,q=()=>{let A=document.querySelector("canvas");A&&(A.remove(),A.width=0,A.height=0)},aA=(()=>{let A=c.appendChild(document.createElement("div"));A.style.float="right",A.style.color="hsl(150,100%,50%)",A.style.textShadow="1px 1px 1px hsl(150,100%,20%)",A.style.fontVariantNumeric="tabular-nums",A.textContent="0 fps";let e=0,t=performance.now();return setInterval(()=>{let r=performance.now();A.textContent=`${Math.round(e*1e3/(r-t))} fps`,e=0,t=r},512),()=>e++})(),y=A=>{let e,t=()=>{A(),aA(),e=requestAnimationFrame(t)};return t(),{cancel:()=>e!==void 0&&cancelAnimationFrame(e)}},Y=A=>{let{row_count:e,column_count:t}=o,r=new Uint8Array(d.buffer,o.cells_ptr,e*t),n=0;for(let j=0;j<e;j++)for(let i=0;i<t;i++)A(j,i,r[n]),n++},Z=A=>{let e=A.getImageData(0,0,A.canvas.width,A.canvas.height),t=new Int32Array(e.data.buffer),r=_(X);for(let n=0;n<A.canvas.width;n+=s+1)for(let j=0;j<A.canvas.height;j++)t[j*A.canvas.width+n]=r;for(let n=0;n<A.canvas.height;n+=s+1)for(let j=0;j<A.canvas.width;j++)t[n*A.canvas.width+j]=r;A.putImageData(e,0,0)},sA=()=>{let A=document.body.appendChild(document.createElement("canvas"));A.width=(s+1)*o.column_count+1,A.height=(s+1)*o.row_count+1;let e=A.getContext("2d");Z(e);let t=V(E),r=V(I),n=()=>{Y((j,i,k)=>{e.fillStyle=k?r:t,e.fillRect(i*(s+1)+1,j*(s+1)+1,s,s)})};return y(()=>{n(),o.tick()})},oA=()=>{let A=document.body.appendChild(document.createElement("canvas"));A.width=(s+1)*o.column_count+1,A.height=(s+1)*o.row_count+1;let e=A.getContext("2d");Z(e);let t=e.getImageData(0,0,A.width,A.height),r=new Int32Array(t.data.buffer),n=(h,b,g,v,w)=>{let p=h+b*A.width;for(let x=0;x<v;x++){for(let f=0;f<g;f++)r[p+f]=w;p+=A.width}},j=_(E),i=_(I),k=()=>{Y((h,b,g)=>{let v=g?i:j,w=b*(s+1)+1,p=h*(s+1)+1;r[w+p*A.width]!==v&&n(w,p,s,s,v)}),e.putImageData(t,0,0)};return y(()=>{k(),o.tick()})},Q=()=>{let A=new l(o.as_ptr,s,_(X),_(E),_(I)),e=new ImageData(new Uint8ClampedArray(d.buffer,A.data_ptr,A.width*A.height*4),A.width,A.height),t=document.body.appendChild(document.createElement("canvas"));t.width=A.width,t.height=A.height;let r=t.getContext("2d");return y(()=>{A.draw(),r.putImageData(e,0,0),o.tick()})};{let{cancel:A}=Q(),e=c.appendChild(document.createElement("div"));e.innerHTML=`
    <label style="cursor:pointer"><input type="radio" name="renderer">Stop</label><br>
    <label style="cursor:pointer"><input type="radio" name="renderer" value="canvas-api">fillRect (JS)</label><br>
    <label style="cursor:pointer"><input type="radio" name="renderer" value="image-data">putImageData (JS)</label><br>
    <label style="cursor:pointer"><input type="radio" name="renderer" value="wasm" checked>putImageData (WASM)</label><br>
  `,e.addEventListener("change",t=>{if(!(!(t.target instanceof HTMLInputElement)||t.target.name!=="renderer"))switch(A(),t.target.value){case"canvas-api":q(),{cancel:A}=sA();break;case"image-data":q(),{cancel:A}=oA();break;case"wasm":q(),{cancel:A}=Q();break;default:A=()=>{};break}})}
