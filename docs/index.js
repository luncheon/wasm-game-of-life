var F="./wasm_game_of_life_bg.wasm";var X=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder,G=new X("utf-8",{ignoreBOM:!0,fatal:!0});G.decode();var _=null;function AA(){return(_===null||_.buffer!==d.buffer)&&(_=new Uint8Array(d.buffer)),_}function jA(j,A){return G.decode(AA().subarray(j,j+A))}var u=class{static __wrap(A){let e=Object.create(u.prototype);return e.ptr=A,e}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();y(A)}constructor(A,e){var t=K(A,e);return u.__wrap(t)}random(){O(this.ptr)}single_space_ship(A,e){M(this.ptr,A,e)}get as_ptr(){var A=D(this.ptr);return A}get cells_ptr(){var A=C(this.ptr);return A}get row_count(){var A=N(this.ptr);return A>>>0}get column_count(){var A=L(this.ptr);return A>>>0}tick(){H(this.ptr)}},v=class{static __wrap(A){let e=Object.create(v.prototype);return e.ptr=A,e}__destroy_into_raw(){let A=this.ptr;return this.ptr=0,A}free(){let A=this.__destroy_into_raw();J(A)}constructor(A,e,t,o,c){var q=R(A,e,t,o,c);return v.__wrap(q)}get width(){var A=S(this.ptr);return A>>>0}get height(){var A=U(this.ptr);return A>>>0}get data_ptr(){var A=W(this.ptr);return A}draw(){T(this.ptr)}};function B(){var j=Date.now();return j}function x(j,A){throw new Error(jA(j,A))}var tA={["./wasm_game_of_life_bg.js"]:{__wbg_now_c3277d0b8a8f625b:B,__wbindgen_throw:x}};async function rA(j,A){if(typeof j=="string"){let e=await fetch(j);if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,A)}catch(t){if(e.headers.get("Content-Type")!="application/wasm")console.warn(t);else throw t}j=await e.arrayBuffer()}return await WebAssembly.instantiate(j,A)}var{instance:n,module:vA}=await rA(F,tA),d=n.exports.memory,y=n.exports.__wbg_universe_free,K=n.exports.universe_new,O=n.exports.universe_random,M=n.exports.universe_single_space_ship,D=n.exports.universe_as_ptr,C=n.exports.universe_cells_ptr,N=n.exports.universe_row_count,L=n.exports.universe_column_count,H=n.exports.universe_tick,J=n.exports.__wbg_universecanvasdrawer_free,R=n.exports.universecanvasdrawer_new,S=n.exports.universecanvasdrawer_width,U=n.exports.universecanvasdrawer_height,W=n.exports.universecanvasdrawer_data_ptr,T=n.exports.universecanvasdrawer_draw;var s=document.body.appendChild(document.createElement("canvas")),i=document.body.appendChild(document.createElement("aside"));i.style.position="fixed";i.style.top="16px";i.style.left="16px";i.style.padding="4px";i.style.background="rgba(255,255,255,.8)";var r=5,Y=[204,204,204],g=[255,255,255],h=[0,0,0],a=new u(600,300);a.random();var E=([j,A,e])=>`rgb(${j},${A},${e})`,l=([j,A,e])=>(255<<24)+(e<<16)+(A<<8)+j,nA=(()=>{let j=i.appendChild(document.createElement("div"));j.style.color="hsl(150,100%,50%)",j.style.textShadow="1px 1px 1px hsl(150,100%,20%)",j.style.fontVariantNumeric="tabular-nums",j.textContent="0 fps";let A=0,e=performance.now();return setInterval(()=>{let t=performance.now();j.textContent=`${Math.round(A*1e3/(t-e))} fps`,A=0,e=t},512),()=>A++})(),f=j=>{let A,e=()=>{j(),nA(),A=requestAnimationFrame(e)};return e(),{cancel:()=>A!==void 0&&cancelAnimationFrame(A)}},Z=j=>{let A=new Uint8Array(d.buffer,a.cells_ptr,Math.ceil(a.row_count*a.column_count/8)),e=0,t=1;for(let o=0;o<a.row_count;o++)for(let c=0;c<a.column_count;c++)j(o,c,(A[e]&t)===t),t===1<<7?(t=1,e++):t<<=1},V=j=>{j.beginPath(),j.strokeStyle=E(Y);for(let A=0;A<=a.column_count;A++)j.moveTo(A*(r+1)+1,0),j.lineTo(A*(r+1)+1,j.canvas.height);for(let A=0;A<=a.row_count;A++)j.moveTo(0,A*(r+1)+1),j.lineTo(j.canvas.width,A*(r+1)+1);j.stroke()},aA=()=>{s.width=(r+1)*a.column_count+1,s.height=(r+1)*a.row_count+1;let j=s.getContext("2d");V(j);let A=E(g),e=E(h),t=()=>{Z((o,c,q)=>{j.fillStyle=q?e:A,j.fillRect(c*(r+1)+1,o*(r+1)+1,r,r)})};return f(()=>{t(),a.tick()})},sA=()=>{s.width=(r+1)*a.column_count+1,s.height=(r+1)*a.row_count+1;let j=s.getContext("2d");V(j);let A=j.getImageData(0,0,s.width,s.height),e=new Uint32Array(A.data.buffer),t=(p,w,k,m,z)=>{let $=p+w*s.width;for(let I=0;I<m;I++){for(let b=0;b<k;b++)e[$+b]=z;$+=s.width}},o=l(g),c=l(h),q=()=>{Z((p,w,k)=>{let m=k?c:o;t(w*(r+1)+1,p*(r+1)+1,r,r,m)}),j.putImageData(A,0,0)};return f(()=>{q(),a.tick()})},P=()=>{let j=new v(a.as_ptr,r,l(Y),l(g),l(h)),A=new ImageData(new Uint8ClampedArray(d.buffer,j.data_ptr,j.width*j.height*4),j.width,j.height);s.width=j.width,s.height=j.height;let e=s.getContext("2d");return f(()=>{j.draw(),e.putImageData(A,0,0),a.tick()})};{let{cancel:j}=P(),A=i.appendChild(document.createElement("div"));A.innerHTML=`
    <label><input type="radio" name="renderer">Stop</label><br>
    <label><input type="radio" name="renderer" value="canvas-api">fillRect (JS)</label><br>
    <label><input type="radio" name="renderer" value="image-data">putImageData (JS)</label><br>
    <label><input type="radio" name="renderer" value="wasm" checked>putImageData (WASM)</label><br>
  `,A.addEventListener("change",e=>{if(!(!(e.target instanceof HTMLInputElement)||e.target.name!=="renderer"))switch(j(),e.target.value){case"canvas-api":({cancel:j}=aA());break;case"image-data":({cancel:j}=sA());break;case"wasm":({cancel:j}=P());break;default:j=()=>{};break}})}
